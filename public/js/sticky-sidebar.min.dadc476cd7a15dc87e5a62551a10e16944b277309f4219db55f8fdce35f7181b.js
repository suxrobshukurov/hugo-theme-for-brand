(function(e,t){typeof exports=="object"&&typeof module!="undefined"?t(exports):typeof define=="function"&&define.amd?define(["exports"],t):t(e.StickySidebar={})})(this,function(e){"use strict";var t,n,s=typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function o(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function i(e,t){return t={exports:{}},e(t,t.exports),t.exports}t=i(function(e,t){(function(e,n){typeof void 0=="function"&&(void 0).amd?(void 0)(["exports"],n):n(t)})(s,function(e){Object.defineProperty(e,"__esModule",{value:!0});function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var s=function(){function e(e,t){for(var n,s=0;s<t.length;s++)n=t[s],n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}return function(t,n,s){return n&&e(t.prototype,n),s&&e(t,s),t}}(),t=function(){var e=".stickySidebar",t={topSpacing:0,bottomSpacing:0,containerSelector:!1,innerWrapperSelector:".inner-wrapper-sticky",stickyClass:"is-affixed",resizeSensor:!0,minWidth:!1},o=function(){function o(e){var s=this,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(n(this,o),this.options=o.extend(t,i),this.sidebar="string"==typeof e?document.querySelector(e):e,"undefined"==typeof this.sidebar)throw new Error("There is no specific sidebar element.");this.sidebarInner=!1,this.container=this.sidebar.parentElement,this.affixedType="STATIC",this.direction="down",this.support={transform:!1,transform3d:!1},this._initialized=!1,this._reStyle=!1,this._breakpoint=!1,this.dimensions={translateY:0,maxTranslateY:0,topSpacing:0,lastTopSpacing:0,bottomSpacing:0,lastBottomSpacing:0,sidebarHeight:0,sidebarWidth:0,containerTop:0,containerHeight:0,viewportHeight:0,viewportTop:0,lastViewportTop:0},["handleEvent"].forEach(function(e){s[e]=s[e].bind(s)}),this.initialize()}return s(o,[{key:"initialize",value:function(){var t,n,s=this;if(this._setSupportFeatures(),this.options.innerWrapperSelector&&(this.sidebarInner=this.sidebar.querySelector(this.options.innerWrapperSelector),null===this.sidebarInner&&(this.sidebarInner=!1)),!this.sidebarInner){for(t=document.createElement("div"),t.setAttribute("class","inner-wrapper-sticky"),this.sidebar.appendChild(t);this.sidebar.firstChild!=t;)t.appendChild(this.sidebar.firstChild);this.sidebarInner=this.sidebar.querySelector(".inner-wrapper-sticky")}if(this.options.containerSelector&&(n=document.querySelectorAll(this.options.containerSelector),n=Array.prototype.slice.call(n),n.forEach(function(e){if(!e.contains(s.sidebar))return;s.container=e}),!n.length))throw new Error("The container does not contains on the sidebar.");"function"!=typeof this.options.topSpacing&&(this.options.topSpacing=parseInt(this.options.topSpacing)||0),"function"!=typeof this.options.bottomSpacing&&(this.options.bottomSpacing=parseInt(this.options.bottomSpacing)||0),this._widthBreakpoint(),this.calcDimensions(),this.stickyPosition(),this.bindEvents(),this._initialized=!0}},{key:"bindEvents",value:function(){window.addEventListener("resize",this,{passive:!0,capture:!1}),window.addEventListener("scroll",this,{passive:!0,capture:!1}),this.sidebar.addEventListener("update"+e,this),this.options.resizeSensor&&"undefined"!=typeof ResizeSensor&&(new ResizeSensor(this.sidebarInner,this.handleEvent),new ResizeSensor(this.container,this.handleEvent))}},{key:"handleEvent",value:function(t){this.updateSticky(t)}},{key:"calcDimensions",value:function(){if(this._breakpoint)return;var t=this.dimensions;t.containerTop=o.offsetRelative(this.container).top,t.containerHeight=this.container.clientHeight,t.containerBottom=t.containerTop+t.containerHeight,t.sidebarHeight=this.sidebarInner.offsetHeight,t.sidebarWidth=this.sidebarInner.offsetWidth,t.viewportHeight=window.innerHeight,t.maxTranslateY=t.containerHeight-t.sidebarHeight,this._calcDimensionsWithScroll()}},{key:"_calcDimensionsWithScroll",value:function(){var t=this.dimensions;t.sidebarLeft=o.offsetRelative(this.sidebar).left,t.viewportTop=document.documentElement.scrollTop||document.body.scrollTop,t.viewportBottom=t.viewportTop+t.viewportHeight,t.viewportLeft=document.documentElement.scrollLeft||document.body.scrollLeft,t.topSpacing=this.options.topSpacing,t.bottomSpacing=this.options.bottomSpacing,"function"==typeof t.topSpacing&&(t.topSpacing=parseInt(t.topSpacing(this.sidebar))||0),"function"==typeof t.bottomSpacing&&(t.bottomSpacing=parseInt(t.bottomSpacing(this.sidebar))||0),"VIEWPORT-TOP"===this.affixedType?t.topSpacing<t.lastTopSpacing&&(t.translateY+=t.lastTopSpacing-t.topSpacing,this._reStyle=!0):"VIEWPORT-BOTTOM"===this.affixedType&&t.bottomSpacing<t.lastBottomSpacing&&(t.translateY+=t.lastBottomSpacing-t.bottomSpacing,this._reStyle=!0),t.lastTopSpacing=t.topSpacing,t.lastBottomSpacing=t.bottomSpacing}},{key:"isSidebarFitsViewport",value:function(){var t=this.dimensions,n=this.scrollDirection==="down"?t.lastBottomSpacing:t.lastTopSpacing;return this.dimensions.sidebarHeight+n<this.dimensions.viewportHeight}},{key:"observeScrollDir",value:function(){var n,t=this.dimensions;if(t.lastViewportTop===t.viewportTop)return;n="down"===this.direction?Math.min:Math.max,t.viewportTop===n(t.viewportTop,t.lastViewportTop)&&(this.direction="down"===this.direction?"up":"down")}},{key:"getAffixType",value:function(){this._calcDimensionsWithScroll();var t=this.dimensions,s=t.viewportTop+t.topSpacing,n=this.affixedType;return s<=t.containerTop||t.containerHeight<=t.sidebarHeight?(t.translateY=0,n="STATIC"):n="up"===this.direction?this._getAffixTypeScrollingUp():this._getAffixTypeScrollingDown(),t.translateY=Math.max(0,t.translateY),t.translateY=Math.min(t.containerHeight,t.translateY),t.translateY=Math.round(t.translateY),t.lastViewportTop=t.viewportTop,n}},{key:"_getAffixTypeScrollingDown",value:function(){var t=this.dimensions,s=t.sidebarHeight+t.containerTop,o=t.viewportTop+t.topSpacing,i=t.viewportBottom-t.bottomSpacing,n=this.affixedType;return this.isSidebarFitsViewport()?t.sidebarHeight+o>=t.containerBottom?(t.translateY=t.containerBottom-s,n="CONTAINER-BOTTOM"):o>=t.containerTop&&(t.translateY=o-t.containerTop,n="VIEWPORT-TOP"):t.containerBottom<=i?(t.translateY=t.containerBottom-s,n="CONTAINER-BOTTOM"):s+t.translateY<=i?(t.translateY=i-s,n="VIEWPORT-BOTTOM"):t.containerTop+t.translateY<=o&&0!==t.translateY&&t.maxTranslateY!==t.translateY&&(n="VIEWPORT-UNBOTTOM"),n}},{key:"_getAffixTypeScrollingUp",value:function(){var t=this.dimensions,o=t.sidebarHeight+t.containerTop,s=t.viewportTop+t.topSpacing,i=t.viewportBottom-t.bottomSpacing,n=this.affixedType;return s<=t.translateY+t.containerTop?(t.translateY=s-t.containerTop,n="VIEWPORT-TOP"):t.containerBottom<=i?(t.translateY=t.containerBottom-o,n="CONTAINER-BOTTOM"):this.isSidebarFitsViewport()||t.containerTop<=s&&0!==t.translateY&&t.maxTranslateY!==t.translateY&&(n="VIEWPORT-UNBOTTOM"),n}},{key:"_getStyle",value:function(t){if("undefined"==typeof t)return;var i,n={inner:{},outer:{}},s=this.dimensions;switch(t){case"VIEWPORT-TOP":n.inner={position:"fixed",top:s.topSpacing,width:s.sidebarWidth};break;case"VIEWPORT-BOTTOM":n.inner={position:"fixed",top:"auto",bottom:s.bottomSpacing,width:s.sidebarWidth};break;case"CONTAINER-BOTTOM":case"VIEWPORT-UNBOTTOM":i=this._getTranslate(0,s.translateY+"px"),i?n.inner={transform:i}:n.inner={position:"absolute",top:s.translateY,width:s.sidebarWidth};break}switch(t){case"VIEWPORT-TOP":case"VIEWPORT-BOTTOM":case"VIEWPORT-UNBOTTOM":case"CONTAINER-BOTTOM":n.outer={height:s.sidebarHeight,position:"relative"};break}return n.outer=o.extend({height:"",position:""},n.outer),n.inner=o.extend({position:"relative",top:"",bottom:"",width:"",transform:""},n.inner),n}},{key:"stickyPosition",value:function(n){if(this._breakpoint)return;n=this._reStyle||n||!1;var a,r,c,l,d,u,h=this.options.topSpacing,m=this.options.bottomSpacing,s=this.getAffixType(),i=this._getStyle(s);if((this.affixedType!=s||n)&&s){c="affix."+s.toLowerCase().replace("viewport-","")+e,o.eventTrigger(this.sidebar,c),"STATIC"===s?o.removeClass(this.sidebar,this.options.stickyClass):o.addClass(this.sidebar,this.options.stickyClass);for(a in i.outer)l="number"==typeof i.outer[a]?"px":"",this.sidebar.style[a]=i.outer[a]+l;for(r in i.inner)d="number"==typeof i.inner[r]?"px":"",this.sidebarInner.style[r]=i.inner[r]+d;u="affixed."+s.toLowerCase().replace("viewport-","")+e,o.eventTrigger(this.sidebar,u)}else this._initialized&&(this.sidebarInner.style.left=i.inner.left);this.affixedType=s}},{key:"_widthBreakpoint",value:function(){window.innerWidth<=this.options.minWidth?(this._breakpoint=!0,this.affixedType="STATIC",this.sidebar.removeAttribute("style"),o.removeClass(this.sidebar,this.options.stickyClass),this.sidebarInner.removeAttribute("style")):this._breakpoint=!1}},{key:"updateSticky",value:function(){var t=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._running)return;this._running=!0,function(e){requestAnimationFrame(function(){switch(e){case"scroll":t._calcDimensionsWithScroll(),t.observeScrollDir(),t.stickyPosition();break;case"resize":default:t._widthBreakpoint(),t.calcDimensions(),t.stickyPosition(!0);break}t._running=!1})}(n.type)}},{key:"_setSupportFeatures",value:function(){var t=this.support;t.transform=o.supportTransform(),t.transform3d=o.supportTransform(!0)}},{key:"_getTranslate",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;return this.support.transform3d?"translate3d("+t+", "+n+", "+s+")":!!this.support.translate&&"translate("+t+", "+n+")"}},{key:"destroy",value:function(){window.removeEventListener("resize",this,{capture:!1}),window.removeEventListener("scroll",this,{capture:!1}),this.sidebar.classList.remove(this.options.stickyClass),this.sidebar.style.minHeight="",this.sidebar.removeEventListener("update"+e,this);var s,o,n={inner:{},outer:{}};n.inner={position:"",top:"",bottom:"",width:"",transform:""},n.outer={height:"",position:""};for(s in n.outer)this.sidebar.style[s]=n.outer[s];for(o in n.inner)this.sidebarInner.style[o]=n.inner[o];this.options.resizeSensor&&"undefined"!=typeof ResizeSensor&&(ResizeSensor.detach(this.sidebarInner,this.handleEvent),ResizeSensor.detach(this.container,this.handleEvent))}}],[{key:"supportTransform",value:function(t){var s=!1,n=t?"perspective":"transform",o=n.charAt(0).toUpperCase()+n.slice(1),i=["Webkit","Moz","O","ms"],a=document.createElement("support"),r=a.style;return(n+" "+i.join(o+" ")+o).split(" ").forEach(function(e){if(r[e]!==void 0)return s=e,!1}),s}},{key:"eventTrigger",value:function(t,n,s){try{var o=new CustomEvent(n,{detail:s})}catch{o=document.createEvent("CustomEvent"),o.initCustomEvent(n,!0,!0,s)}t.dispatchEvent(o)}},{key:"extend",value:function(t,n){var s,o={};for(s in t)"undefined"!=typeof n[s]?o[s]=n[s]:o[s]=t[s];return o}},{key:"offsetRelative",value:function(t){var s,o,n={left:0,top:0};do s=t.offsetTop,o=t.offsetLeft,isNaN(s)||(n.top+=s),isNaN(o)||(n.left+=o),t="BODY"===t.tagName?t.parentElement:t.offsetParent;while(t)return n}},{key:"addClass",value:function(t,n){o.hasClass(t,n)||(t.classList?t.classList.add(n):t.className+=" "+n)}},{key:"removeClass",value:function(t,n){o.hasClass(t,n)&&(t.classList?t.classList.remove(n):t.className=t.className.replace(new RegExp("(^|\\b)"+n.split(" ").join("|")+"(\\b|$)","gi")," "))}},{key:"hasClass",value:function(t,n){return t.classList?t.classList.contains(n):new RegExp("(^| )"+n+"( |$)","gi").test(t.className)}},{key:"defaults",get:function(){return t}}]),o}();return o}();e.default=t,window.StickySidebar=t})}),n=o(t),e.default=n,e.__moduleExports=t,Object.defineProperty(e,"__esModule",{value:!0})})